<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guaribada Tracker</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #4f46e5;
            cursor: pointer;
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [activeTab, setActiveTab] = useState('home'); // 'home' ou 'stats'
            const [showModal, setShowModal] = useState(false);
            const [editingId, setEditingId] = useState(null);
            const [logs, setLogs] = useState([]);
            const [privacyMode, setPrivacyMode] = useState(false);
            
            // Estados do Form
            const [title, setTitle] = useState('');
            const [type, setType] = useState('sexo');
            const [date, setDate] = useState(new Date().toISOString().substr(0, 10));
            const [duration, setDuration] = useState(30);
            const [intensity, setIntensity] = useState(3);

            useEffect(() => {
                const saved = localStorage.getItem('guaribada_v1');
                if (saved) setLogs(JSON.parse(saved));
            }, []);

            useEffect(() => {
                localStorage.setItem('guaribada_v1', JSON.stringify(logs));
            }, [logs]);

            const handleSave = (e) => {
                e.preventDefault();
                const newLog = {
                    id: editingId || Date.now(),
                    title: title || (type === 'sexo' ? 'Sexo' : 'Solo'),
                    type, date, duration: parseInt(duration), intensity
                };
                if (editingId) {
                    setLogs(logs.map(l => l.id === editingId ? newLog : l));
                } else {
                    setLogs([newLog, ...logs]);
                }
                closeModal();
            };

            const closeModal = () => {
                setShowModal(false);
                setEditingId(null);
                setTitle('');
                setDuration(30);
            };

            const deleteLog = (id, e) => {
                e.stopPropagation();
                if(confirm("Apagar este registro?")) {
                    setLogs(logs.filter(l => l.id !== id));
                }
            };

            const formatDuration = (mins) => {
                if (mins < 60) return `${mins} min`;
                const h = Math.floor(mins / 60);
                const m = mins % 60;
                return m > 0 ? `${h}h ${m}m` : `${h}h`;
            };

            // C√°lculos para Insights
            const stats = {
                sexo: logs.filter(l => l.type === 'sexo'),
                solo: logs.filter(l => l.type === 'masturbacao'),
            };

            const getAverage = (arr) => {
                if (arr.length === 0) return 0;
                const total = arr.reduce((acc, curr) => acc + curr.duration, 0);
                return Math.round(total / arr.length);
            };

            return (
                <div className="max-w-md mx-auto min-h-screen bg-slate-50 flex flex-col relative shadow-2xl">
                    
                    {/* Conte√∫do Principal */}
                    <main className="flex-1 p-6 pt-12 overflow-y-auto">
                        
                        {activeTab === 'home' ? (
                            <div className="animate-fade-in space-y-6">
                                <div className="bg-slate-900 rounded-[2.5rem] p-8 text-white shadow-xl">
                                    <div className="flex justify-between items-start mb-6">
                                        <div>
                                            <p className="text-indigo-400 text-[10px] font-black uppercase tracking-widest">Total de Guaribadas</p>
                                            <h1 className="text-5xl font-black">{privacyMode ? '***' : logs.length}</h1>
                                        </div>
                                        <button onClick={() => setPrivacyMode(!privacyMode)} className="bg-white/10 p-3 rounded-2xl transition-colors hover:bg-white/20">
                                            {privacyMode ? "üîì" : "üîí"}
                                        </button>
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="bg-white/5 p-4 rounded-2xl border border-white/10">
                                            <p className="text-[9px] text-slate-400 uppercase font-black">Sexo</p>
                                            <p className="text-xl font-bold">{privacyMode ? '*' : stats.sexo.length}</p>
                                        </div>
                                        <div className="bg-white/5 p-4 rounded-2xl border border-white/10">
                                            <p className="text-[9px] text-slate-400 uppercase font-black">Solo</p>
                                            <p className="text-xl font-bold">{privacyMode ? '*' : stats.solo.length}</p>
                                        </div>
                                    </div>
                                </div>

                                <button onClick={() => setShowModal(true)} className="w-full bg-indigo-600 text-white p-6 rounded-[2rem] font-black flex items-center justify-center gap-3 shadow-lg shadow-indigo-200 active:scale-95 transition-all">
                                    <span className="text-2xl">+</span> NOVO REGISTRO
                                </button>

                                <div className="space-y-4">
                                    <h2 className="font-black text-xl text-slate-800 px-2">Hist√≥rico Recente</h2>
                                    {logs.length === 0 ? (
                                        <p className="text-center py-10 text-slate-400 font-medium">Nenhum registro encontrado.</p>
                                    ) : (
                                        logs.map(log => (
                                            <div key={log.id} className="bg-white p-5 rounded-[2rem] border border-slate-100 flex justify-between items-center shadow-sm group">
                                                <div className="flex items-center gap-4">
                                                    <div className={`w-12 h-12 rounded-2xl flex items-center justify-center text-xl ${log.type === 'sexo' ? 'bg-rose-50 text-rose-500' : 'bg-indigo-50 text-indigo-600'}`}>
                                                        {log.type === 'sexo' ? 'üë•' : 'üë§'}
                                                    </div>
                                                    <div>
                                                        <p className="font-black text-slate-800">{privacyMode ? '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢' : log.title}</p>
                                                        <p className="text-[10px] font-bold text-slate-400 uppercase">{new Date(log.date).toLocaleDateString('pt-BR')} ‚Ä¢ {formatDuration(log.duration)}</p>
                                                    </div>
                                                </div>
                                                <button onClick={(e) => deleteLog(log.id, e)} className="text-slate-200 hover:text-red-400 p-2 transition-colors">
                                                    üóëÔ∏è
                                                </button>
                                            </div>
                                        ))
                                    )}
                                </div>
                            </div>
                        ) : (
                            <div className="animate-fade-in space-y-6">
                                <h2 className="text-3xl font-black text-slate-800 tracking-tight">Insights</h2>
                                
                                <div className="grid grid-cols-1 gap-4">
                                    <div className="bg-rose-500 p-6 rounded-[2.5rem] text-white shadow-lg">
                                        <p className="text-[10px] font-black uppercase opacity-80 mb-1">M√©dia de Tempo (Sexo)</p>
                                        <p className="text-3xl font-black">{formatDuration(getAverage(stats.sexo))}</p>
                                    </div>
                                    
                                    <div className="bg-indigo-600 p-6 rounded-[2.5rem] text-white shadow-lg">
                                        <p className="text-[10px] font-black uppercase opacity-80 mb-1">M√©dia de Tempo (Solo)</p>
                                        <p className="text-3xl font-black">{formatDuration(getAverage(stats.solo))}</p>
                                    </div>

                                    <div className="bg-white p-6 rounded-[2.5rem] border border-slate-200 shadow-sm">
                                        <p className="text-[10px] font-black text-slate-400 uppercase mb-4">Distribui√ß√£o de Intensidade</p>
                                        <div className="flex items-end justify-between h-24 px-2 gap-2">
                                            {[1,2,3,4,5].map(level => {
                                                const count = logs.filter(l => l.intensity === level).length;
                                                const height = logs.length ? (count / logs.length) * 100 : 0;
                                                return (
                                                    <div key={level} className="flex-1 flex flex-col items-center gap-2">
                                                        <div className="w-full bg-indigo-100 rounded-t-lg relative flex items-end overflow-hidden" style={{height: '100%'}}>
                                                            <div className="w-full bg-indigo-500 transition-all duration-500" style={{height: `${height}%`}}></div>
                                                        </div>
                                                        <span className="text-[10px] font-black text-slate-400">{level}‚òÖ</span>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>

                    {/* Navega√ß√£o Inferior */}
                    <nav className="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-white/80 backdrop-blur-md border-t border-slate-100 p-4 flex justify-around items-center z-40">
                        <button 
                            onClick={() => setActiveTab('home')}
                            className={`flex flex-col items-center gap-1 transition-all ${activeTab === 'home' ? 'text-indigo-600 scale-110' : 'text-slate-300'}`}
                        >
                            <span className="text-2xl">üè†</span>
                            <span className="text-[9px] font-black uppercase">In√≠cio</span>
                        </button>
                        
                        <div className="w-12"></div> {/* Espa√ßo para o bot√£o central se quiser adicionar depois */}

                        <button 
                            onClick={() => setActiveTab('stats')}
                            className={`flex flex-col items-center gap-1 transition-all ${activeTab === 'stats' ? 'text-indigo-600 scale-110' : 'text-slate-300'}`}
                        >
                            <span className="text-2xl">üìä</span>
                            <span className="text-[9px] font-black uppercase">Insights</span>
                        </button>
                    </nav>

                    {/* Modal de Registro */}
                    {showModal && (
                        <div className="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 flex items-end">
                            <div className="bg-white w-full rounded-t-[3rem] p-8 pb-12 shadow-2xl animate-fade-in">
                                <div className="flex justify-between items-center mb-8">
                                    <h3 className="text-2xl font-black text-slate-800">Nova Guaribada</h3>
                                    <button onClick={closeModal} className="w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center font-bold text-slate-400">‚úï</button>
                                </div>
                                <form onSubmit={handleSave} className="space-y-6">
                                    <div className="space-y-2">
                                        <label className="text-[10px] font-black text-slate-400 uppercase ml-2">T√≠tulo</label>
                                        <input type="text" placeholder="Ex: Noite de sexta" className="w-full p-4 bg-slate-50 border border-slate-100 rounded-2xl font-bold outline-none focus:ring-2 ring-indigo-500/20" value={title} onChange={e => setTitle(e.target.value)} />
                                    </div>

                                    <div className="flex gap-3">
                                        <button type="button" onClick={() => setType('sexo')} className={`flex-1 py-4 rounded-2xl font-black transition-all ${type==='sexo' ? 'bg-rose-500 text-white shadow-lg shadow-rose-200' : 'bg-slate-100 text-slate-400'}`}>üë• SEXO</button>
                                        <button type="button" onClick={() => setType('masturbacao')} className={`flex-1 py-4 rounded-2xl font-black transition-all ${type==='masturbacao' ? 'bg-indigo-600 text-white shadow-lg shadow-indigo-200' : 'bg-slate-100 text-slate-400'}`}>üë§ SOLO</button>
                                    </div>

                                    <div className="space-y-4">
                                        <div className="flex justify-between items-center px-2">
                                            <label className="text-[10px] font-black text-slate-400 uppercase">Dura√ß√£o</label>
                                            <span className="bg-indigo-50 text-indigo-600 px-3 py-1 rounded-full text-xs font-black">{formatDuration(duration)}</span>
                                        </div>
                                        <input type="range" min="30" max="600" step="30" value={duration} onChange={e => setDuration(e.target.value)} className="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer" />
                                    </div>

                                    <div className="space-y-3">
                                        <label className="text-[10px] font-black text-slate-400 uppercase text-center block">Intensidade</label>
                                        <div className="flex justify-between px-4">
                                            {[1,2,3,4,5].map(i => (
                                                <button key={i} type="button" onClick={() => setIntensity(i)} className={`w-10 h-10 rounded-xl font-black transition-all ${intensity===i ? 'bg-indigo-600 text-white scale-110' : 'text-slate-300 bg-slate-50'}`}>{i}</button>
                                            ))}
                                        </div>
                                    </div>

                                    <button className="w-full bg-slate-900 text-white py-5 rounded-[2rem] font-black text-lg shadow-xl active:scale-95 transition-all">SALVAR REGISTRO</button>
                                </form>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
